import csv
import math
import mysql.connector
from mysql.connector import Error

connection = mysql.connector.connect(
  host="localhost",
  user="debian-sys-maint",
  passwd="HwearQMC4nkPeYmP",
  database="censoindex"
)

line_count = 0
with open('ESCOLAS.CSV') as csv_file:
	csv_reader = csv.reader(csv_file, delimiter='\n')

	for row in csv_reader:
	
		data = row[0].split("|")
		
		# https://stackoverflow.com/questions/522563/accessing-the-index-in-for-loops
		for idx, val in enumerate(data):
			if val == "":
				data[idx] = 0

		try:
			cursor = connection.cursor()
			sql = "INSERT INTO escolas (NU_ANO_CENSO, CO_ENTIDADE, NO_ENTIDADE, CO_ORGAO_REGIONAL, TP_SITUACAO_FUNCIONAMENTO, DT_ANO_LETIVO_INICIO, DT_ANO_LETIVO_TERMINO, CO_REGIAO, CO_MESORREGIAO, CO_MICRORREGIAO, CO_UF, CO_MUNICIPIO, CO_DISTRITO, TP_DEPENDENCIA, TP_LOCALIZACAO, TP_LOCALIZACAO_DIFERENCIADA, IN_VINCULO_SECRETARIA_EDUCACAO, IN_VINCULO_SEGURANCA_PUBLICA, IN_VINCULO_SECRETARIA_SAUDE, IN_VINCULO_OUTRO_ORGAO, TP_CATEGORIA_ESCOLA_PRIVADA, IN_CONVENIADA_PP, TP_CONVENIO_PODER_PUBLICO, IN_MANT_ESCOLA_PRIVADA_EMP, IN_MANT_ESCOLA_PRIVADA_ONG, IN_MANT_ESCOLA_PRIVADA_OSCIP, IN_MANT_ESCOLA_PRIV_ONG_OSCIP, IN_MANT_ESCOLA_PRIVADA_SIND, IN_MANT_ESCOLA_PRIVADA_SIST_S, IN_MANT_ESCOLA_PRIVADA_S_FINS, TP_REGULAMENTACAO, TP_RESPONSAVEL_REGULAMENTACAO, CO_ESCOLA_SEDE_VINCULADA, CO_IES_OFERTANTE, IN_LOCAL_FUNC_PREDIO_ESCOLAR, TP_OCUPACAO_PREDIO_ESCOLAR, IN_LOCAL_FUNC_SOCIOEDUCATIVO, IN_LOCAL_FUNC_UNID_PRISIONAL, IN_LOCAL_FUNC_PRISIONAL_SOCIO, IN_LOCAL_FUNC_GALPAO, TP_OCUPACAO_GALPAO, IN_LOCAL_FUNC_SALAS_OUTRA_ESC, IN_LOCAL_FUNC_OUTROS, IN_PREDIO_COMPARTILHADO, IN_AGUA_POTAVEL, IN_AGUA_REDE_PUBLICA, IN_AGUA_POCO_ARTESIANO, IN_AGUA_CACIMBA, IN_AGUA_FONTE_RIO, IN_AGUA_INEXISTENTE, IN_ENERGIA_REDE_PUBLICA, IN_ENERGIA_GERADOR_FOSSIL, IN_ENERGIA_RENOVAVEL, IN_ENERGIA_INEXISTENTE, IN_ESGOTO_REDE_PUBLICA, IN_ESGOTO_FOSSA_SEPTICA, IN_ESGOTO_FOSSA_COMUM, IN_ESGOTO_FOSSA, IN_ESGOTO_INEXISTENTE, IN_LIXO_SERVICO_COLETA, IN_LIXO_QUEIMA, IN_LIXO_ENTERRA, IN_LIXO_DESTINO_FINAL_PUBLICO, IN_LIXO_DESCARTA_OUTRA_AREA, IN_TRATAMENTO_LIXO_SEPARACAO, IN_TRATAMENTO_LIXO_REUTILIZA, IN_TRATAMENTO_LIXO_RECICLAGEM, IN_TRATAMENTO_LIXO_INEXISTENTE, IN_ALMOXARIFADO, IN_AREA_VERDE, IN_AUDITORIO, IN_BANHEIRO, IN_BANHEIRO_EI, IN_BANHEIRO_PNE, IN_BANHEIRO_FUNCIONARIOS, IN_BANHEIRO_CHUVEIRO, IN_BIBLIOTECA, IN_BIBLIOTECA_SALA_LEITURA, IN_COZINHA, IN_DESPENSA, IN_DORMITORIO_ALUNO, IN_DORMITORIO_PROFESSOR, IN_LABORATORIO_CIENCIAS, IN_LABORATORIO_INFORMATICA, IN_PATIO_COBERTO, IN_PATIO_DESCOBERTO, IN_PARQUE_INFANTIL, IN_PISCINA, IN_QUADRA_ESPORTES, IN_QUADRA_ESPORTES_COBERTA, IN_QUADRA_ESPORTES_DESCOBERTA, IN_REFEITORIO, IN_SALA_ATELIE_ARTES, IN_SALA_MUSICA_CORAL, IN_SALA_ESTUDIO_DANCA, IN_SALA_MULTIUSO, IN_SALA_DIRETORIA, IN_SALA_LEITURA, IN_SALA_PROFESSOR, IN_SALA_REPOUSO_ALUNO, IN_SECRETARIA, IN_SALA_ATENDIMENTO_ESPECIAL, IN_TERREIRAO, IN_VIVEIRO, IN_DEPENDENCIAS_OUTRAS, IN_ACESSIBILIDADE_CORRIMAO, IN_ACESSIBILIDADE_ELEVADOR, IN_ACESSIBILIDADE_PISOS_TATEIS, IN_ACESSIBILIDADE_VAO_LIVRE, IN_ACESSIBILIDADE_RAMPAS, IN_ACESSIBILIDADE_SINAL_SONORO, IN_ACESSIBILIDADE_SINAL_TATIL, IN_ACESSIBILIDADE_SINAL_VISUAL, IN_ACESSIBILIDADE_INEXISTENTE, QT_SALAS_UTILIZADAS_DENTRO, QT_SALAS_UTILIZADAS_FORA, QT_SALAS_UTILIZADAS, QT_SALAS_UTILIZA_CLIMATIZADAS, QT_SALAS_UTILIZADAS_ACESSIVEIS, IN_EQUIP_PARABOLICA, IN_COMPUTADOR, IN_EQUIP_COPIADORA, IN_EQUIP_IMPRESSORA, IN_EQUIP_IMPRESSORA_MULT, IN_EQUIP_SCANNER, IN_EQUIP_DVD, QT_EQUIP_DVD, IN_EQUIP_SOM, QT_EQUIP_SOM, IN_EQUIP_TV, QT_EQUIP_TV, IN_EQUIP_LOUSA_DIGITAL, QT_EQUIP_LOUSA_DIGITAL, IN_EQUIP_MULTIMIDIA, QT_EQUIP_MULTIMIDIA, IN_DESKTOP_ALUNO, QT_DESKTOP_ALUNO, IN_COMP_PORTATIL_ALUNO, QT_COMP_PORTATIL_ALUNO, IN_TABLET_ALUNO, QT_TABLET_ALUNO, IN_INTERNET, IN_INTERNET_ALUNOS, IN_INTERNET_ADMINISTRATIVO, IN_INTERNET_APRENDIZAGEM, IN_INTERNET_COMUNIDADE, IN_ACESSO_INTERNET_COMPUTADOR, IN_ACES_INTERNET_DISP_PESSOAIS, TP_REDE_LOCAL, IN_BANDA_LARGA, QT_PROF_ADMINISTRATIVOS, QT_PROF_SERVICOS_GERAIS, QT_PROF_BIBLIOTECARIO, QT_PROF_SAUDE, QT_PROF_COORDENADOR, QT_PROF_FONAUDIOLOGO, QT_PROF_NUTRICIONISTA, QT_PROF_PSICOLOGO, QT_PROF_ALIMENTACAO, QT_PROF_PEDAGOGIA, QT_PROF_SECRETARIO, QT_PROF_SEGURANCA, QT_PROF_MONITORES, IN_ALIMENTACAO, IN_SERIE_ANO, IN_PERIODOS_SEMESTRAIS, IN_FUNDAMENTAL_CICLOS, IN_GRUPOS_NAO_SERIADOS, IN_MODULOS, IN_FORMACAO_ALTERNANCIA, IN_MATERIAL_PED_MULTIMIDIA, IN_MATERIAL_PED_INFANTIL, IN_MATERIAL_PED_CIENTIFICO, IN_MATERIAL_PED_DIFUSAO, IN_MATERIAL_PED_MUSICAL, IN_MATERIAL_PED_JOGOS, IN_MATERIAL_PED_ARTISTICAS, IN_MATERIAL_PED_DESPORTIVA, IN_MATERIAL_PED_INDIGENA, IN_MATERIAL_PED_ETNICO, IN_MATERIAL_PED_CAMPO, IN_EDUCACAO_INDIGENA, TP_INDIGENA_LINGUA, CO_LINGUA_INDIGENA_1, CO_LINGUA_INDIGENA_2, CO_LINGUA_INDIGENA_3, IN_EXAME_SELECAO, IN_RESERVA_PPI, IN_RESERVA_RENDA, IN_RESERVA_PUBLICA, IN_RESERVA_PCD, IN_RESERVA_OUTROS, IN_RESERVA_NENHUMA, IN_REDES_SOCIAIS, IN_ESPACO_ATIVIDADE, IN_ESPACO_EQUIPAMENTO, IN_ORGAO_ASS_PAIS, IN_ORGAO_ASS_PAIS_MESTRES, IN_ORGAO_CONSELHO_ESCOLAR, IN_ORGAO_GREMIO_ESTUDANTIL, IN_ORGAO_OUTROS, IN_ORGAO_NENHUM, TP_PROPOSTA_PEDAGOGICA, TP_AEE, TP_ATIVIDADE_COMPLEMENTAR, IN_MEDIACAO_PRESENCIAL, IN_MEDIACAO_SEMIPRESENCIAL, IN_MEDIACAO_EAD, IN_ESPECIAL_EXCLUSIVA, IN_REGULAR, IN_EJA, IN_PROFISSIONALIZANTE, IN_COMUM_CRECHE, IN_COMUM_PRE, IN_COMUM_FUND_AI, IN_COMUM_FUND_AF, IN_COMUM_MEDIO_MEDIO, IN_COMUM_MEDIO_INTEGRADO, IN_COMUM_MEDIO_NORMAL, IN_ESP_EXCLUSIVA_CRECHE, IN_ESP_EXCLUSIVA_PRE, IN_ESP_EXCLUSIVA_FUND_AI, IN_ESP_EXCLUSIVA_FUND_AF, IN_ESP_EXCLUSIVA_MEDIO_MEDIO, IN_ESP_EXCLUSIVA_MEDIO_INTEGR, IN_ESP_EXCLUSIVA_MEDIO_NORMAL, IN_COMUM_EJA_FUND, IN_COMUM_EJA_MEDIO, IN_COMUM_EJA_PROF, IN_ESP_EXCLUSIVA_EJA_FUND, IN_ESP_EXCLUSIVA_EJA_MEDIO, IN_ESP_EXCLUSIVA_EJA_PROF, IN_COMUM_PROF, IN_ESP_EXCLUSIVA_PROF) VALUES (%s,%s,'%s','%s',%s,'%s','%s',%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s, %s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s)" % (data[0],data[1],data[2],data[3],data[4],data[5],data[6],data[7],data[8],data[9],data[10],data[11],data[12],data[13],data[14],data[15],data[16],data[17],data[18],data[19],data[20],data[21],data[22],data[23],data[24],data[25],data[26],data[27],data[28],data[29],data[30],data[31],data[32],data[33],data[34],data[35],data[36],data[37],data[38],data[39],data[40],data[41],data[42],data[43],data[44],data[45],data[46],data[47],data[48],data[49],data[50],data[51],data[52],data[53],data[54],data[55],data[56],data[57],data[58],data[59],data[60],data[61],data[62],data[63],data[64],data[65],data[66],data[67],data[68],data[69],data[70],data[71],data[72],data[73],data[74],data[75],data[76],data[77],data[78],data[79],data[80],data[81],data[82],data[83],data[84],data[85],data[86],data[87],data[88],data[89],data[90],data[91],data[92],data[93],data[94],data[95],data[96],data[97],data[98],data[99],data[100],data[101],data[102],data[103],data[104],data[105],data[106],data[107],data[108],data[109],data[110],data[111],data[112],data[113],data[114],data[115],data[116],data[117],data[118],data[119],data[120],data[121],data[122],data[123],data[124],data[125],data[126],data[127],data[128],data[129],data[130],data[131],data[132],data[133],data[134],data[135],data[136],data[137],data[138],data[139],data[140],data[141],data[142],data[143],data[144],data[145],data[146],data[147],data[148],data[149],data[150],data[151],data[152],data[153],data[154],data[155],data[156],data[157],data[158],data[159],data[160],data[161],data[162],data[163],data[164],data[165],data[166],data[167],data[168],data[169],data[170],data[171],data[172],data[173],data[174],data[175],data[176],data[177],data[178],data[179],data[180],data[181],data[182],data[183],data[184],data[185],data[186],data[187],data[188],data[189],data[190],data[191],data[192],data[193],data[194],data[195],data[196],data[197],data[198],data[199],data[200],data[201],data[202],data[203],data[204],data[205],data[206],data[207],data[208],data[209],data[210],data[211],data[212],data[213],data[214],data[215],data[216],data[217],data[218],data[219],data[220],data[221],data[222],data[223],data[224],data[225],data[226],data[227],data[228],data[229],data[230],data[231],data[232], data[233])
			#print (sql)		

			cursor.execute(sql)
			connection.commit()	
		except TypeError as e:
			print("Erro" )
			print (sql)
